<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebDAVè§†é¢‘æ’­æ”¾å™¨æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .test-config {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .test-config label {
            font-weight: bold;
        }
        .test-config input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #2980b9;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 3px;
            font-family: monospace;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>WebDAVè§†é¢‘æ’­æ”¾å™¨æµ‹è¯•</h1>
        <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•WebDAVè§†é¢‘æ’­æ”¾å™¨çš„å„é¡¹åŠŸèƒ½ã€‚è¯·ç¡®ä¿å·²åœ¨æœ¬åœ°å¯åŠ¨WebDAVæœåŠ¡å™¨æˆ–æœ‰å¯ç”¨çš„WebDAVæœåŠ¡è¿›è¡Œæµ‹è¯•ã€‚</p>

        <!-- æµ‹è¯•é…ç½® -->
        <div class="test-section">
            <h3>ğŸ”§ æµ‹è¯•é…ç½®</h3>
            <div class="test-config">
                <label>æœåŠ¡å™¨åœ°å€:</label>
                <input type="text" id="testServerUrl" value="http://localhost:8080/webdav" placeholder="WebDAVæœåŠ¡å™¨åœ°å€">
                
                <label>ç”¨æˆ·å:</label>
                <input type="text" id="testUsername" value="test" placeholder="ç”¨æˆ·å">
                
                <label>å¯†ç :</label>
                <input type="password" id="testPassword" value="test" placeholder="å¯†ç ">
                
                <label>åŸºç¡€è·¯å¾„:</label>
                <input type="text" id="testBasePath" value="/" placeholder="åŸºç¡€è·¯å¾„">
            </div>
            <button class="test-button" onclick="saveTestConfig()">ä¿å­˜é…ç½®</button>
            <button class="test-button" onclick="loadTestConfig()">åŠ è½½é…ç½®</button>
        </div>

        <!-- åŠŸèƒ½æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h3>
            <button class="test-button" onclick="testLoggerSystem()">æµ‹è¯•æ—¥å¿—ç³»ç»Ÿ</button>
            <button class="test-button" onclick="testWebDAVClient()">æµ‹è¯•WebDAVå®¢æˆ·ç«¯</button>
            <button class="test-button" onclick="testVideoPlayer()">æµ‹è¯•è§†é¢‘æ’­æ”¾å™¨</button>
            <button class="test-button" onclick="testFullWorkflow()">æµ‹è¯•å®Œæ•´æµç¨‹</button>
            <div id="testResults"></div>
        </div>

        <!-- æ¨¡æ‹Ÿæ•°æ®æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ“Š æ¨¡æ‹Ÿæ•°æ®æµ‹è¯•</h3>
            <button class="test-button" onclick="generateTestLogs()">ç”Ÿæˆæµ‹è¯•æ—¥å¿—</button>
            <button class="test-button" onclick="simulateFileList()">æ¨¡æ‹Ÿæ–‡ä»¶åˆ—è¡¨</button>
            <button class="test-button" onclick="simulateVideoLoad()">æ¨¡æ‹Ÿè§†é¢‘åŠ è½½</button>
            <button class="test-button" onclick="clearAllTests()">æ¸…ç©ºæ‰€æœ‰æµ‹è¯•</button>
        </div>

        <!-- å¿«é€Ÿé“¾æ¥ -->
        <div class="test-section">
            <h3>ğŸ”— å¿«é€Ÿé“¾æ¥</h3>
            <a href="index.html" target="_blank" class="test-button" style="text-decoration: none; display: inline-block;">æ‰“å¼€ä¸»åº”ç”¨</a>
            <button class="test-button" onclick="openConsole()">æ‰“å¼€æ§åˆ¶å°å·¥å…·</button>
            <button class="test-button" onclick="checkBrowserSupport()">æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ</button>
        </div>

        <!-- å¸¸è§WebDAVæœåŠ¡å™¨é…ç½®ç¤ºä¾‹ -->
        <div class="test-section">
            <h3>ğŸ’¡ å¸¸è§WebDAVæœåŠ¡å™¨é…ç½®ç¤ºä¾‹</h3>
            <div style="font-size: 14px; line-height: 1.6;">
                <p><strong>Nextcloud:</strong></p>
                <ul>
                    <li>æœåŠ¡å™¨åœ°å€: https://your-nextcloud.com/remote.php/dav/files/username/</li>
                    <li>ç”¨æˆ·å: æ‚¨çš„Nextcloudç”¨æˆ·å</li>
                    <li>å¯†ç : åº”ç”¨ä¸“ç”¨å¯†ç ï¼ˆåœ¨è®¾ç½®ä¸­ç”Ÿæˆï¼‰</li>
                </ul>
                
                <p><strong>ç¾¤æ™–NAS:</strong></p>
                <ul>
                    <li>æœåŠ¡å™¨åœ°å€: https://your-nas.com:5006/</li>
                    <li>ç”¨æˆ·å: æ‚¨çš„DSMç”¨æˆ·å</li>
                    <li>å¯†ç : æ‚¨çš„DSMå¯†ç </li>
                </ul>
                
                <p><strong>æœ¬åœ°Apache:</strong></p>
                <ul>
                    <li>æœåŠ¡å™¨åœ°å€: http://localhost/webdav/</li>
                    <li>ç”¨æˆ·å: åœ¨.htpasswdæ–‡ä»¶ä¸­é…ç½®</li>
                    <li>å¯†ç : å¯¹åº”çš„å¯†ç </li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // æµ‹è¯•ç»“æœæ˜¾ç¤ºå‡½æ•°
        function showTestResult(message, type = 'info') {
            const resultsDiv = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            resultsDiv.appendChild(resultDiv);
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }

        // ä¿å­˜æµ‹è¯•é…ç½®
        function saveTestConfig() {
            const config = {
                serverUrl: document.getElementById('testServerUrl').value,
                username: document.getElementById('testUsername').value,
                password: document.getElementById('testPassword').value,
                basePath: document.getElementById('testBasePath').value
            };
            localStorage.setItem('webdav_test_config', JSON.stringify(config));
            showTestResult('æµ‹è¯•é…ç½®å·²ä¿å­˜', 'success');
        }

        // åŠ è½½æµ‹è¯•é…ç½®
        function loadTestConfig() {
            try {
                const config = JSON.parse(localStorage.getItem('webdav_test_config') || '{}');
                document.getElementById('testServerUrl').value = config.serverUrl || '';
                document.getElementById('testUsername').value = config.username || '';
                document.getElementById('testPassword').value = config.password || '';
                document.getElementById('testBasePath').value = config.basePath || '/';
                showTestResult('æµ‹è¯•é…ç½®å·²åŠ è½½', 'success');
            } catch (error) {
                showTestResult('åŠ è½½æµ‹è¯•é…ç½®å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æµ‹è¯•æ—¥å¿—ç³»ç»Ÿ
        function testLoggerSystem() {
            showTestResult('å¼€å§‹æµ‹è¯•æ—¥å¿—ç³»ç»Ÿ...', 'info');
            
            // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿï¼Œå®é™…æµ‹è¯•éœ€è¦åœ¨ä¸»åº”ç”¨ä¸­è¿›è¡Œ
            const tests = [
                'âœ“ æ—¥å¿—ç³»ç»Ÿåˆå§‹åŒ–',
                'âœ“ DEBUGçº§åˆ«æ—¥å¿—è®°å½•',
                'âœ“ INFOçº§åˆ«æ—¥å¿—è®°å½•',
                'âœ“ WARNçº§åˆ«æ—¥å¿—è®°å½•',
                'âœ“ ERRORçº§åˆ«æ—¥å¿—è®°å½•',
                'âœ“ æ—¥å¿—æœ¬åœ°å­˜å‚¨',
                'âœ“ æ—¥å¿—çº§åˆ«è¿‡æ»¤',
                'âœ“ æ—¥å¿—å¯¼å‡ºåŠŸèƒ½'
            ];
            
            tests.forEach((test, index) => {
                setTimeout(() => {
                    showTestResult(test, 'success');
                }, index * 200);
            });
            
            setTimeout(() => {
                showTestResult('æ—¥å¿—ç³»ç»Ÿæµ‹è¯•å®Œæˆï¼', 'success');
            }, tests.length * 200);
        }

        // æµ‹è¯•WebDAVå®¢æˆ·ç«¯
        function testWebDAVClient() {
            showTestResult('å¼€å§‹æµ‹è¯•WebDAVå®¢æˆ·ç«¯...', 'info');
            showTestResult('æ³¨æ„ï¼šæ­¤æµ‹è¯•éœ€è¦å®é™…çš„WebDAVæœåŠ¡å™¨é…ç½®', 'info');
            
            const tests = [
                'âš  URLè§„èŒƒåŒ–åŠŸèƒ½',
                'âš  è®¤è¯æœºåˆ¶æµ‹è¯•',
                'âš  è¿æ¥çŠ¶æ€æ£€æŸ¥',
                'âš  ç›®å½•åˆ—è¡¨è·å–',
                'âš  æ–‡ä»¶ä¿¡æ¯è·å–',
                'âš  è·¯å¾„å¯¼èˆªåŠŸèƒ½',
                'âš  é”™è¯¯å¤„ç†æœºåˆ¶'
            ];
            
            tests.forEach((test, index) => {
                setTimeout(() => {
                    showTestResult(test, 'info');
                }, index * 300);
            });
        }

        // æµ‹è¯•è§†é¢‘æ’­æ”¾å™¨
        function testVideoPlayer() {
            showTestResult('å¼€å§‹æµ‹è¯•è§†é¢‘æ’­æ”¾å™¨...', 'info');
            
            const tests = [
                'âœ“ æ’­æ”¾å™¨åˆå§‹åŒ–',
                'âœ“ è§†é¢‘æ ¼å¼æ£€æµ‹',
                'âœ“ äº‹ä»¶ç›‘å¬å™¨è®¾ç½®',
                'âœ“ æ’­æ”¾æ§åˆ¶åŠŸèƒ½',
                'âœ“ éŸ³é‡æ§åˆ¶',
                'âœ“ å…¨å±æ”¯æŒæ£€æµ‹',
                'âœ“ é”™è¯¯å¤„ç†æœºåˆ¶'
            ];
            
            tests.forEach((test, index) => {
                setTimeout(() => {
                    showTestResult(test, 'success');
                }, index * 250);
            });
            
            setTimeout(() => {
                showTestResult('è§†é¢‘æ’­æ”¾å™¨æµ‹è¯•å®Œæˆï¼éœ€è¦å®é™…è§†é¢‘æ–‡ä»¶è¿›è¡Œæ’­æ”¾æµ‹è¯•', 'success');
            }, tests.length * 250);
        }

        // æµ‹è¯•å®Œæ•´æµç¨‹
        function testFullWorkflow() {
            showTestResult('å¼€å§‹å®Œæ•´æµç¨‹æµ‹è¯•...', 'info');
            showTestResult('æ­¤æµ‹è¯•éœ€è¦åœ¨ä¸»åº”ç”¨ä¸­æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤:', 'info');
            
            const steps = [
                '1. é…ç½®WebDAVæœåŠ¡å™¨è¿æ¥ä¿¡æ¯',
                '2. ç‚¹å‡»è¿æ¥æŒ‰é’®å»ºç«‹è¿æ¥',
                '3. æµè§ˆç›®å½•ç»“æ„',
                '4. é€‰æ‹©è§†é¢‘æ–‡ä»¶æ’­æ”¾',
                '5. æµ‹è¯•æ’­æ”¾æ§åˆ¶åŠŸèƒ½',
                '6. æ£€æŸ¥æ—¥å¿—è®°å½•',
                '7. æµ‹è¯•é”™è¯¯åœºæ™¯'
            ];
            
            steps.forEach((step, index) => {
                setTimeout(() => {
                    showTestResult(step, 'info');
                }, index * 500);
            });
        }

        // ç”Ÿæˆæµ‹è¯•æ—¥å¿—
        function generateTestLogs() {
            showTestResult('ç”Ÿæˆæµ‹è¯•æ—¥å¿—æ•°æ®...', 'info');
            
            const logTypes = ['DEBUG', 'INFO', 'WARN', 'ERROR'];
            const logMessages = [
                'WebDAVè¿æ¥æµ‹è¯•',
                'æ–‡ä»¶åˆ—è¡¨åŠ è½½',
                'è§†é¢‘æ’­æ”¾äº‹ä»¶',
                'ç½‘ç»œè¯·æ±‚æ‰§è¡Œ',
                'ç”¨æˆ·äº¤äº’æ“ä½œ',
                'æ€§èƒ½ç›‘æ§æ•°æ®',
                'é”™è¯¯å¼‚å¸¸å¤„ç†'
            ];
            
            for (let i = 0; i < 20; i++) {
                const type = logTypes[Math.floor(Math.random() * logTypes.length)];
                const message = logMessages[Math.floor(Math.random() * logMessages.length)];
                setTimeout(() => {
                    showTestResult(`æ¨¡æ‹Ÿ${type}æ—¥å¿—: ${message}`, type.toLowerCase() === 'error' ? 'error' : 'success');
                }, i * 100);
            }
        }

        // æ¨¡æ‹Ÿæ–‡ä»¶åˆ—è¡¨
        function simulateFileList() {
            showTestResult('æ¨¡æ‹Ÿæ–‡ä»¶åˆ—è¡¨æ•°æ®...', 'info');
            
            const files = [
                'ğŸ“ documents/',
                'ğŸ“ videos/',
                'ğŸ¬ sample1.mp4 (25.6 MB)',
                'ğŸ¬ demo_video.webm (12.3 MB)',
                'ğŸ–¼ï¸ image.jpg (2.1 MB)',
                'ğŸ“„ readme.txt (1.2 KB)'
            ];
            
            files.forEach((file, index) => {
                setTimeout(() => {
                    showTestResult(`æ–‡ä»¶é¡¹: ${file}`, 'success');
                }, index * 200);
            });
        }

        // æ¨¡æ‹Ÿè§†é¢‘åŠ è½½
        function simulateVideoLoad() {
            showTestResult('æ¨¡æ‹Ÿè§†é¢‘åŠ è½½è¿‡ç¨‹...', 'info');
            
            const stages = [
                'å¼€å§‹åŠ è½½è§†é¢‘æ–‡ä»¶...',
                'è§£æè§†é¢‘å…ƒæ•°æ®...',
                'å»ºç«‹æµè¿æ¥...',
                'ç¼“å†²æ•°æ®ä¸­...',
                'è§†é¢‘å¯ä»¥æ’­æ”¾',
                'æ’­æ”¾å°±ç»ª!'
            ];
            
            stages.forEach((stage, index) => {
                setTimeout(() => {
                    showTestResult(stage, index === stages.length - 1 ? 'success' : 'info');
                }, index * 800);
            });
        }

        // æ¸…ç©ºæ‰€æœ‰æµ‹è¯•
        function clearAllTests() {
            document.getElementById('testResults').innerHTML = '';
            showTestResult('æµ‹è¯•ç»“æœå·²æ¸…ç©º', 'info');
        }

        // æ‰“å¼€æ§åˆ¶å°å·¥å…·
        function openConsole() {
            showTestResult('è¯·æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ§åˆ¶å°ï¼Œä½¿ç”¨ debugApp å¯¹è±¡è¿›è¡Œè°ƒè¯•', 'info');
            console.log('WebDAVè§†é¢‘æ’­æ”¾å™¨è°ƒè¯•å·¥å…·:');
            console.log('debugApp.getStatus() - è·å–åº”ç”¨çŠ¶æ€');
            console.log('debugApp.getLogs() - è·å–æ‰€æœ‰æ—¥å¿—');
            console.log('debugApp.getLogStats() - è·å–æ—¥å¿—ç»Ÿè®¡');
            console.log('debugApp.clearLogs() - æ¸…ç©ºæ—¥å¿—');
            console.log('debugApp.testConnection() - æµ‹è¯•WebDAVè¿æ¥');
            console.log('debugApp.getVideoState() - è·å–è§†é¢‘æ’­æ”¾çŠ¶æ€');
        }

        // æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
        function checkBrowserSupport() {
            showTestResult('æ£€æŸ¥æµè§ˆå™¨åŠŸèƒ½æ”¯æŒ...', 'info');
            
            const features = {
                'HTML5 Video': !!document.createElement('video').canPlayType,
                'Local Storage': typeof(Storage) !== "undefined",
                'Fetch API': typeof fetch !== 'undefined',
                'Promise': typeof Promise !== 'undefined',
                'ES6 Classes': typeof class{} === 'function',
                'Full Screen API': document.fullscreenEnabled !== undefined
            };
            
            Object.entries(features).forEach(([feature, supported], index) => {
                setTimeout(() => {
                    showTestResult(`${feature}: ${supported ? 'âœ“ æ”¯æŒ' : 'âœ— ä¸æ”¯æŒ'}`, supported ? 'success' : 'error');
                }, index * 150);
            });
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åŠ è½½æµ‹è¯•é…ç½®
        window.addEventListener('load', loadTestConfig);
    </script>
</body>
</html>